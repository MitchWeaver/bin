#!/bin/sh
#
# http://github.com/mitchweaver/bin
#
# local backup to my nas
#
# shellcheck disable=2086
#

host=pi
user=root
array=/mnt/array
rsync='rsync -rtvuh --progress --delete --partial --links --update'

$rsync --exclude '*cache*' /home/mitch/ /mnt/4TB/mitch-bkup
$rsync /etc/ /mnt/4TB/etc-bkup 2>/dev/null

$rsync /mnt/4TB/ $user@$host:$array

# fix permissions for roku to access via minidlna
ssh $user@$host chmod -R 0755 $array/videos
ssh $user@$host chmod -R 0755 $array/music
ssh $user@$host systemctl restart minidlna
