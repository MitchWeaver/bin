#!/bin/sh

get_song() {
    if pgrep -x mpv >/dev/null ; then
        song="$(song)"
        [ "$song" ] && echo "[ SONG: $(song) ]"
    fi
}

get_vpn() {
    if [ -f /tmp/vpn ] && pgrep -x openvpn >/dev/null ; then
        echo "$(cat /tmp/vpn)"
    else
        echo None
    fi
}

get_ssid() {
    ssid="$(ssid)"
    if [ "$ssid" ] ; then
        echo "$ssid"
    else
        echo "No Internet"
    fi
}

while xsetroot -name \
"\
$(get_song)\
[ TEMP: $(temp) ]\
[ SSID: $(get_ssid) ]\
[ VPN: $(get_vpn) ]\
[ BRI: $(bright)% ]\
[ BAT: $(bperc)% ]\
[ VOL: $(vol)% ]\
[ $(date '+%a %b %d - %I:%M %p') ]\
"
do
    sleep 5
done
