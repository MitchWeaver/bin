#!/bin/sh
#
# http://github.com/mitchweaver/bin
#
# autorice using pywal and other tools
#

WALL_PATH="${HOME}/.cache/wall"

usage() {
    >&2 echo 'Usage: rice [-l] <wallpaper>'
    exit 1
}

while [ "$1" ] ; do
    case "$1" in
        -l) LIGHT=true ;;
        -h) usage ;;
        *)
            if [ -f "$1" ] ; then
                path="$1"
            else
                usage
            fi
    esac
    shift
done

cp -f "$path" "$WALL_PATH"

background "$WALL_PATH" &

if [ "$LIGHT" ] ; then
    wal -qnli "$path"
else
    wal -qni "$path"
fi >/dev/null

cat ${HOME}/.cache/wal/sequences

# recomp suckless tools
recomp st tabbed dwm

# generate web browser startpage css
if type sassc >/dev/null 2>&1 ; then
    spage=${HOME}/src/startpage
    sassc $spage/scss/style.scss $spage/style.css
    rm -r ${HOME}/Downloads/.startpage 2>/dev/null
    cp -rf ${HOME}/src/startpage ${HOME}/Downloads/.startpage
fi
