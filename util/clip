#!/bin/sh
#
# http://github.com/mitchweaver/bin
#
# a tiny xsel/dmenu based clipboard manager
#

log=~/.cache/clip.log

case $1 in
    --daemon|-d)
        :>"$log"
        while sleep 1 ; do
            new=$(xsel -op)
            [ "$new" = "$old" ] && continue
            printf '%s\n' "$new" >>"$log"
            old=$new
        done
        ;;
    *)
        sel=$(sort -ur "$log" | menu -p 'Clip:')
        [ "$sel" ] &&
        for clip in p s b ; do printf '%s' "$sel" | xsel -i$clip ; done
esac
