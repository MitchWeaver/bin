#!/bin/sh
#
# http://github.com/mitchweaver/bin
#
# a tiny xsel/dmenu based clipboard manager
#

log=${HOME}/.cache/clip.log

case "$1" in
    --daemon|-d)
        :>"$log"
        while sleep 1 ; do
            new="$(xsel -op)"
            [ "$new" = "$old" ] && continue
            echo "$new" >>"$log"
            old="$new"
        done
        ;;
    *)
        sel="$(sort -ur "$log" | menu -p 'Clip:')"
        [ "$sel" ] || exit 1
        echo -n "$sel" | xsel -ib
        echo -n "$sel" | xsel -is
        echo -n "$sel" | xsel -ip
esac
