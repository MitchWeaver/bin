#!/bin/sh
#
# http://github.com/mitchweaver/bin
#
# play a given directory with mpv and display album art.
#

dir="$@"

if pgrep xwinwrap >/dev/null ; then
    kill $(pgrep -a mpv | grep -v mpvbg | awk '{print $1}') >/dev/null 2>&1
else
    pkill -9 mpv
fi

set -- $(dimensions)
w=$(( $1 / 4 ))

nohup mpv --really-quiet --no-video --input-ipc-server=/tmp/mpvsocket \
    --title=mpv "$dir" >/dev/null 2>&1 &

nohup feh -Z --stretch --ignore-aspect --auto-rotate --title feh \
    --scale-down -q -g ${w}x${w} "$dir"/ >/dev/null 2>&1 &
