#!/bin/sh
#
# http://github.com/mitchweaver/bin
#
# routine backups to my vps with git
#

if pgrep -x openvpn > /dev/null ; then
    >&2 echo "Hey, turn off your vpn first!"
    exit 1
fi

bk() {
    cd "$1"
    git add -A > /dev/null
    git commit -q -m "Automated Commit $(date)" > /dev/null
    git push -u origin master
}

for dir in backup bin fonts ; do
    bk ${HOME}/usr/$dir &
done

for dir in files images music ; do
    bk ${HOME}/var/$dir &
done

bk ${HOME}/src/startpage

wait

echo 'all backed up!'
